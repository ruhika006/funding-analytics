syntax = "proto3";

package api.v1;

import "buf/validate/validate.proto";

option go_package = "api/v1";

// -------------------------------
// Query Service
// -------------------------------
service QueryService {
  // 1. Get all startup records (limit optional)
  rpc GetRecords(GetRecordsRequest) returns (GetRecordsResponse);

  // 2. Top funded industries (all time)
  rpc GetTopIndustries(GetTopIndustriesRequest) returns (GetTopIndustriesResponse);

  // 3. Top industries funded by year
  rpc GetTopIndustriesByYear(GetTopIndustriesByYearRequest) returns (GetTopIndustriesByYearResponse);

  // 4. Most funded startups (all time)
  rpc GetTopFundedStartups(GetTopFundedStartupsRequest) returns (GetTopFundedStartupsResponse);

  // 5. Top funded industries & cities
  rpc GetTopCityAndIndustries(GetTopCityAndIndustriesRequest) returns (GetTopCityAndIndustriesResponse);
}

// -------------------------------
// 1. Get Records
// -------------------------------
message GetRecordsRequest {
  int32 limit = 1 [(buf.validate.field).int32 = {gte: 1, lte: 100}];
}

message StartupRecord {
  string company = 1;
  string industry = 2;
  string funding_amount = 3; // Already formatted
  string investor = 4;
  int32 year = 5;
  string city = 6;
}

message GetRecordsResponse {
  repeated StartupRecord records = 1;
}

// -------------------------------
// 2. Top Industries (all time)
// -------------------------------
message GetTopIndustriesRequest {
  int32 limit = 1 [(buf.validate.field).int32 = {gte: 1, lte: 1000}];
}

message IndustryFunding {
  string industry = 1;
  string total_funds = 2; // formatted
}

message GetTopIndustriesResponse {
  repeated IndustryFunding industries = 1;
}

// -------------------------------
// 3. Top Industries by Year
// -------------------------------
message GetTopIndustriesByYearRequest {
  int32 year = 1 [(buf.validate.field).int32 = {gte: 2010, lte: 2025}];
  int32 limit = 2 [(buf.validate.field).int32 = {gte: 1, lte: 1000}];
}

message GetTopIndustriesByYearResponse {
  repeated IndustryFunding industries = 1;
}

// -------------------------------
// 4. Top Funded Startups
// -------------------------------
message GetTopFundedStartupsRequest {
  int32 limit = 1 [(buf.validate.field).int32 = {gte: 1, lte: 100}];
}

message StartupFunding {
  string company = 1;
  string total_funds = 2; // formatted
}

message GetTopFundedStartupsResponse {
  repeated StartupFunding startups = 1;
}

// -------------------------------
// 5. Top City & Industries
// -------------------------------
message GetTopCityAndIndustriesRequest {
  string city = 1;
  string industry = 2;
  int32 limit = 3 [(buf.validate.field).int32 = {gte: 1, lte: 20}];
}

message CityIndustryFunding {
  string industry = 1;
  string city = 2;
  string total_funds = 3;
}

message GetTopCityAndIndustriesResponse {
  repeated CityIndustryFunding results = 1;
}
